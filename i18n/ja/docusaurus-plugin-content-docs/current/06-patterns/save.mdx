---
title: Save
description: Saving within Grafana is a multi-tiered pattern that varies depending on the required amount of friction and importance of the item being saved.
hide_title: true
---

import { Badge, InfoBox } from '@grafana/ui';

# 保存 <Badge text='ready' color='green'></Badge>

Grafanaにおける保存は、必要な摩擦の量（参照: [デザイン原則: 適度な摩擦](/foundations/design-principles#tasteful-friction)）と保存対象の重要度に応じて多段階のパターンが存在します。

## 階層

適切な保存パターンを使用するために、以下に各パターンの定義と使用例を示します。

### 自動保存

このパターンはすべての保存パターンの中でユーザーへの摩擦が最も少ないものです。ユーザーは明示的にシステムに保存を指示する必要がなく、システムは変更を検知して指定された時間待機した後、自動的にリクエストをトリガーします。自動保存は、保存が成功したことをユーザーに通知するインラインのトースト通知に依存しています。

#### 実装

自動保存フィールドは、影響度が低いと見なされる領域でのみ実装されます。このような摩擦の少ないパターンであるため、ユーザーが害を及ぼさない領域でのみ有効にすることが重要です。チーム名や表示名の変更などは、このコンポーネントの適切な使用例です。現在Grafanaには「元に戻す」機能がないため、ユーザーが手動で簡単に元に戻せる項目にのみ自動保存を使用してください。

各自動保存フィールドには、インライン検証とローディング状態が必須です。これにより、ユーザーはシステムが調整を更新していることを認識できます。また、各フィールドは保存前に変更をチェックし、保存リクエストの数を最小限に抑えます。これはGrafanaの最新の保存パターンであるため、一部の入力タイプではローディング状態や無効状態の追加が進行中であることに注意してください。

#### 使用法

**推奨**

- 変更が機密的でなく、追加の摩擦が必要ない場合に自動保存を使用します。
- ユーザーが変更に対して即時の反応を期待する場合に自動保存を使用します。
- 保存が行われたことを確認するインラインのトーストが表示されるようにします。

**非推奨**

- 他の保存パターンも使用されているページで自動保存を使用しないでください。
- 他のユーザーに影響を与えるアクション（組織のデフォルト言語、ダッシュボードの変更など）に自動保存を使用しないでください。

### インライン保存

インライン保存パターンはフォーム内で利用され、編集または更新されたさまざまなユーザー入力をシステムに保存して更新するためのボタンをユーザーに提供します。

#### 実装

インライン保存は、オブジェクトに対して明示的な保存アクションが必要な領域で使用する必要があります。特に、エンティティが行で表示され、ユーザーが1つ以上の行を編集している場合に有用です。

#### 使用法

**推奨**

- フィールドが変更された後に保存ボタンを有効にします。
- 無効であっても保存アクションを常に表示します。
- 未保存の変更がある状態でユーザーが別のページに移動しようとした場合、未保存変更の警告を表示します。
- 保存が成功したことを示すトーストメッセージを表示します。

**非推奨**

- 未保存の変更がない場合でも保存ボタンを有効にしないでください。
- 保存ボタンを追加のクリックの背後に隠したり、何かが変更されるまで表示しないでください。
- ページ全体に作用しない不必要な保存ボタンを追加表示しないでください。

### 適用して保存

「適用」は、ユーザーが変更の結果をテストできるようにしますが、その値を保存しないため、ユーザーは変更/更新をプレビューできます。未保存の変更がある状態でユーザーが別のページに移動しようとした場合、未保存変更の警告が表示されます。

「保存」は値を永続的に変更します。保存の成功またはエラーは、トーストを通じてユーザーに表示されます。

ユーザーが「適用」を使用した後、「保存」する前に別のページに移動しようとした場合、未保存変更の警告が表示される必要があります。

#### 実装

「適用して保存」は、ユーザーが変更を実際に確定する前にプレビューしたい場合に使用するべきパターンです。中程度から中高程度の影響がある領域でこのパターンを使用します。Grafanaでは、このパターンはダッシュボードの編集で最も一般的に使用されます。ユーザーにとって有用であるためには、適用済みだが未保存の状態と、既に保存済みの状態を明確に区別する必要があります。

**推奨事項**

- ユーザーが適用したがまだ保存していない場合に、未保存の変更警告を表示する。
- 保存が成功したことを示すトーストメッセージを表示する。
- 変更を保存する前に、適用した変更をキャンセルできる手段を提供する。
- 理想的には、変更がない限り「適用」ボタンを無効にし、同様に変更がない限り「保存」ボタンも無効にする。

**非推奨事項**

- ユーザーが「適用」をクリックした時点で保存しない。

### ページ保存

フォームで最もよく見られるパターンで、通常はプライマリの保存ボタンで示され、クリックするとフォームのすべての内容が保存されます。ユーザーが保存せずに別のページに移動しようとする場合、未保存の警告が表示されるべきです。

「保存」は値を永続的に変更します。保存の成功またはエラーはトーストでユーザーに表示されるべきです。ユーザーが「適用」を使用したがまだ「保存」していない状態で移動しようとする場合、未保存の変更警告が表示されるべきです。

#### 実装方法

ページ保存は中程度の影響がある領域で使用するべきです。フォームで最もよく見られ、通常はプライマリの保存ボタンで示され、クリックするとフォームのすべての内容が保存されます。このパターンはページ全体を保存するためのもので、ページの一部のみを保存したい場合は、代わりにインライン保存を検討してください。

**推奨事項**

- ページ上で何かが変更された後に保存ボタンを有効にする。
- 無効な場合でも常に保存アクションを表示する。
- ユーザーが未保存の変更がある状態で移動しようとする場合、未保存の変更警告を表示する。
- 保存が成功したことを示すトーストメッセージを表示する。

**非推奨事項**

- 未保存の変更がない場合でも保存ボタンを有効にしない。
- 保存ボタンを追加のクリックの背後に隠したり、何かが変更されるまで表示しない。
- 1ページに複数の保存ボタンを表示しない。

### ダイアログ保存

最も摩擦の多いこのパターンは、ユーザーが変更を完全に認識していることを確認するために、ユーザーの全集中を必要とします。変更には波及効果があり、ユーザーが更新の結果を認識し受け入れる必要があります。

#### 実装方法

ダイアログ保存は、主に以下の2つの方法でトリガーされます：

1. **未保存の変更警告**: ユーザーが未保存の作業から移動しようとする場合、未保存の変更警告ダイアログを表示し、ユーザーに変更を保存または破棄するオプションを提供します。
2. **高影響の変更**: ユーザーが重要な変更を保存する場合、変更の影響を説明し、変更を保存または破棄することを許可する確認モーダルを表示します。

発生する可能性のある問題（おそらく推奨/非推奨セクションに変更します）：
未保存の警告から呼び出されることが多いが、期待通りに表示されないことがある。

**推奨事項**

- 変更が失われる可能性のあるナビゲーション時に未保存の変更警告を表示する。
- 高影響の変更の規模や範囲を明確に説明する。例：「この変更は75人のユーザーに影響します。保存してもよろしいですか？」

**非推奨事項**

- ユーザーが移動する際に自動的に保存すると仮定しない。**選択はユーザーに委ねるべきであり、私たちが決めるものではありません。**

### 未保存の変更

ユーザーが未保存の変更があるページから離れようとした場合、変更を保存しないと失われることを警告するアラートまたはモーダルを使用する必要があります。このパターンは、ユーザーがタブを閉じる、ブラウザの戻るボタンを使用する、または他のナビゲーション要素をクリックするなど、間接的なユーザーアクションの結果として発生します。詳細は「ダイアログ保存」を参照してください。

### リダイレクト

ユーザー、チーム、レポートやSLOなどのより大きなエンティティなど、新しいコンテンツを作成する際には、作成フローの最後にユーザーを新しく作成したコンテンツにリダイレクトする必要があります。特定のページでのリダイレクトアクションは一貫性を保つようにしてください。

ただし、パネルエディタは例外です。変更を保存した後は、ユーザーが変更をダッシュボード全体のコンテキストで確認できるように、ダッシュボードにリダイレクトする必要があります。なお、パネルエディタの動作は現在作業中であるため、現時点ではこのパターンを再利用しないでください。